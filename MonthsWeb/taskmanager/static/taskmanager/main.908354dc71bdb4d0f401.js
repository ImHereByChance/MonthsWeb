(()=>{var __webpack_modules__={193:(t,e,s)=>{const{copyObject:i,toDateField:a,arraysEquals:n,DateFormat:o,translate:r}=s(975);class h{constructor(t){this._object=i(t),this.id=t.id,this.date=t.date,this.init_date=t.init_date,this.title=t.title,this.description=t.description,this.completion=t.completion,this.interval=t.interval,this.autoshift=t.autoshift,this.files=t.files}set id(t){if(!t)throw"task should have id";if(Math.ceil(t)!=t)throw"task id should be an integer";if(t<1)throw"task id should be >= 1";this._object.id=t}get id(){return this._object.id}set date(t){try{this._object.date=a(t)}catch(t){throw TypeError(`Invalid value of date: ${t.message}`)}}get date(){return this._object.date}set init_date(t){try{this._object.init_date=a(t)}catch(t){throw TypeError(`Invalid value of init_date: ${t.message}`)}}get init_date(){return this._object.init_date}set title(t){this._object.title=t}get title(){return this._object.title}set description(t){this._object.description=t}get description(){return this._object.description}set completion(t){if(!1===t)this._object.completion=t;else try{this._object.completion=a(t)}catch(t){throw TypeError(`Invalid value of completion: ${t.message}`)}}get completion(){return this._object.completion}set interval(t){if("no"===t||!1===t)this._object.interval=t;else{if(this._object.autoshift)throw"cannot assign interval to the task where exists autoshift value";this._object.interval=t}}get interval(){return this._object.interval}set autoshift(t){if(!1===t)this._object.autoshift=t;else{if("no"!==this._object.interval&&this._object.interval)throw"cannot assign autoshift to the task where exists interval value";this._object.autoshift=t}}get autoshift(){return this._object.autoshift}set files(t){this._object.files=t}get files(){return this._object.files}get object(){let t=i(this._object);for(let e of Object.keys(t))t[e]instanceof Date&&(t[e]=o.toProperISOString(t[e]));return t}static getEmpty(t){let e={id:void 0,date:void 0,init_date:void 0,title:"",description:"",completion:!1,interval:"no",autoshift:!1,files:[]};return t&&Object.assign(e,t),e}}class c extends Array{constructor(...t){super(...t),this._convertToTaskObjects(this)}static from(t,...e){let s=super.from(t,(t=>t instanceof h?t:new h(t)));return e?super.from(s,...e):s}checkDailyTasks(t){let e=!1;for(let s of this)if(n([s.date.getDate(),s.date.getMonth()],[t.getDate(),t.getMonth()])){if(!s.completion)return"got tasks";e=!0}return e?"tasks done":"no tasks"}getDailyTasks(t){let e=[];for(let s of this)t.getDate()===s.date.getDate()&&t.getMonth()===s.date.getMonth()&&e.push(s);return e}_convertToTaskObjects(t){for(let e of t.keys())if(!(this.key instanceof h)){if(void 0===this[e])break;this[e]=new h(this[e])}}}class l extends Array{constructor(...t){super(...t),this._convertStringsToDates(this)}static from(t,...e){let s=super.from(t,(t=>new Date(t)));return e?super.from(s,...e):s}_convertStringsToDates(t){for(let e of t.keys())this[e]=new Date(this[e])}}t.exports={CacheService:class{constructor(t){this.transportService=t,this.today=new Date,this.pageDate=this.today,this.datesArray=[],this.tasksArray=[]}setPageDate(t){return console.log(`%c requesting data for changing page date: ${this.pageDate}`,"color: cornflowerblue"),this.transportService.getMonthPack(t).then((e=>{this.pageDate=t,this.datesArray=l.from(e.dates),this.tasksArray=c.from(e.tasks),console.log("%c requested data successfully received from the server","color: yellowgreen"),console.log(this.tasksArray)})).catch((t=>{throw console.log(`%c Failed to receive data for changing page date: ${this.pageDate}`,"color: crimson"),t}))}createTask(t){for(let e in t)t[e]instanceof Date&&(t[e]=o.toProperISOString(t[e]));return this.transportService.addNewTask(t).then((()=>{console.log("%c the task successfully added to DB","color: yellowgreen")})).then((()=>this.setPageDate(this.pageDate))).catch((t=>{throw console.error("fail to add the task"),t}))}deleteTask(t){return this.transportService.deleteTask(t.id).then((()=>{console.log("%c the task was successfully deleted from DB","color: yellowgreen");let e=this.tasksArray.indexOf(t);this.tasksArray.splice(e,1)})).catch((t=>{throw console.error("failed to delete the task"),t}))}editTask(t){for(let e in t)t[e]instanceof Date&&(t[e]=o.toProperISOString(t[e]));return this.transportService.changeTask(t).then((()=>{console.log("%c the task successfully changed at DB","color: yellowgreen")})).then((()=>this.setPageDate(this.pageDate))).catch((t=>{throw console.error("fail to edit the task"),t}))}checkUncheckTask(t){const e=t.date,s=t.completion;for(let e in t)t[e]instanceof Date&&(t[e]=o.toProperISOString(t[e]));return this.transportService.changeTask(t,!0).then((()=>{console.log("%c information about the task completion was changed on DB","color: yellowgreen");for(let i of this.tasksArray)if(i.id===t.id&&i.date===e){i.completion=s;break}})).catch((t=>{throw console.error("failed to change information about the task completion on DB"),t}))}},TaskObject:h,TaskArray:c,DatesArray:l}},176:(t,e,s)=>{const i=s(6);t.exports=new i({LOCALE_TAG:"en",SERVER_URLs:{base:"http://emilkadermetov.pythonanywhere.com/",changeDate:"/getDatePack",tasks:"/tasks"}})},6:(t,e,s)=>{const i=s(769);t.exports=class{constructor(t){for(let e in t)e in this||(this[e]=t[e])}get LOCALE(){const t=i[this.LOCALE_TAG];if(!t)throw`there is no such locale in the localesRegister: ${this.LOCALE_TAG}`;return t}}},733:(t,e,s)=>{const{PopUpWindow:i}=s(54);class a extends Error{constructor(t){super(t),this.name="MissingServerError",this.displayPopup()}displayPopup(){new i({parent:_mainContainer,cssClass:"popup-defaultError",irreversible:!0,caption:this.message,svgPicture:svgPaths.oopsError}).build()}}class n extends Error{constructor(t,e){super(t),this.name="ServerError",this.statusCode=e,this.displayPopup()}displayPopup(){new i({parent:_mainContainer,cssClass:"popup-defaultError",caption:this.message,svgPicture:svgPaths.oopsError}).build()}}class o extends Error{constructor(t,e){super(t),this.name="ClientError",this.statusCode=e,this.displayPopup()}displayPopup(){new i({parent:_mainContainer,cssClass:"popup-defaultError",caption:this.message,svgPicture:svgPaths.oopsError}).build()}}t.exports={MissingServerError:a,ServerError:n,ClientError:o}},804:t=>{t.exports={languageTag:"en"}},769:(t,e,s)=>{t.exports={en:s(804),ru:s(313)}},313:t=>{t.exports={languageTag:"ru-Ru",lines:{"No tasks":"Задач нет","Postpone:":"Отложить:","Repeat:":"Повторять:","Auto postpone:":"Автоперенос:","Task name:":"Название:","Description:":"Описание:","no interval":"без интервала","every day":"ежедневно","every workday":"по будням","every week":"еженедельно","every month":"ежемесячно","every year":"ежегодно","until completed":"до выполнения",no:"нет",ok:"ок","server is temporary unavailable..":"сервер временно недоступен..","A task should have a title":"У задачи должно быть название"}}},201:t=>{svgPaths={saveTask:'<svg class="svg-icon" viewBox="0 0 20 20">\n               <path fill="none" d="M9.917,0.875c-5.086,0-9.208,4.123-9.208,9.208c0,5.086,4.123,9.208,9.208,9.208s9.208-4.122,9.208-9.208\n               C19.125,4.998,15.003,0.875,9.917,0.875z M9.917,18.141c-4.451,0-8.058-3.607-8.058-8.058s3.607-8.057,8.058-8.057\n               c4.449,0,8.057,3.607,8.057,8.057S14.366,18.141,9.917,18.141z M13.851,6.794l-5.373,5.372L5.984,9.672\n               c-0.219-0.219-0.575-0.219-0.795,0c-0.219,0.22-0.219,0.575,0,0.794l2.823,2.823c0.02,0.028,0.031,0.059,0.055,0.083\n               c0.113,0.113,0.263,0.166,0.411,0.162c0.148,0.004,0.298-0.049,0.411-0.162c0.024-0.024,0.036-0.055,0.055-0.083l5.701-5.7\n               c0.219-0.219,0.219-0.575,0-0.794C14.425,6.575,14.069,6.575,13.851,6.794z"></path>\n               </svg>',pointLeft:'<svg class="svg-icon" viewBox="0 0 20 20">\n                <path fill="none" d="M8.388,10.049l4.76-4.873c0.303-0.31,0.297-0.804-0.012-1.105c-0.309-0.304-0.803-0.293-1.105,0.012L6.726,9.516c-0.303,0.31-0.296,0.805,0.012,1.105l5.433,5.307c0.152,0.148,0.35,0.223,0.547,0.223c0.203,0,0.406-0.08,0.559-0.236c0.303-0.309,0.295-0.803-0.012-1.104L8.388,10.049z"></path>\n                </svg>',pointRight:'<svg class="svg-icon" viewBox="0 0 20 20">\n                 <path fill="none" d="M11.611,10.049l-4.76-4.873c-0.303-0.31-0.297-0.804,0.012-1.105c0.309-0.304,0.803-0.293,1.105,0.012l5.306,5.433c0.304,0.31,0.296,0.805-0.012,1.105L7.83,15.928c-0.152,0.148-0.35,0.223-0.547,0.223c-0.203,0-0.406-0.08-0.559-0.236c-0.303-0.309-0.295-0.803,0.012-1.104L11.611,10.049z"></path>\n                 </svg>',addTask:'<svg class="svg-icon" viewBox="0 0 20 20">\n              <path fill="none" d="M13.388,9.624h-3.011v-3.01c0-0.208-0.168-0.377-0.376-0.377S9.624,6.405,9.624,6.613v3.01H6.613c-0.208,0-0.376,0.168-0.376,0.376s0.168,0.376,0.376,0.376h3.011v3.01c0,0.208,0.168,0.378,0.376,0.378s0.376-0.17,0.376-0.378v-3.01h3.011c0.207,0,0.377-0.168,0.377-0.376S13.595,9.624,13.388,9.624z M10,1.344c-4.781,0-8.656,3.875-8.656,8.656c0,4.781,3.875,8.656,8.656,8.656c4.781,0,8.656-3.875,8.656-8.656C18.656,5.219,14.781,1.344,10,1.344z M10,17.903c-4.365,0-7.904-3.538-7.904-7.903S5.635,2.096,10,2.096S17.903,5.635,17.903,10S14.365,17.903,10,17.903z"></path>\n              </svg>',editTask:'<svg class="svg-icon" viewBox="0 0 20 20">\n               <path d="M10,2.172c-4.324,0-7.828,3.504-7.828,7.828S5.676,17.828,10,17.828c4.324,0,7.828-3.504,7.828-7.828S14.324,2.172,10,2.172M10,17.004c-3.863,0-7.004-3.141-7.004-7.003S6.137,2.997,10,2.997c3.862,0,7.004,3.141,7.004,7.004S13.862,17.004,10,17.004M10,8.559c-0.795,0-1.442,0.646-1.442,1.442S9.205,11.443,10,11.443s1.441-0.647,1.441-1.443S10.795,8.559,10,8.559 M10,10.619c-0.34,0-0.618-0.278-0.618-0.618S9.66,9.382,10,9.382S10.618,9.661,10.618,10S10.34,10.619,10,10.619 M14.12,8.559c-0.795,0-1.442,0.646-1.442,1.442s0.647,1.443,1.442,1.443s1.442-0.647,1.442-1.443S14.915,8.559,14.12,8.559 M14.12,10.619c-0.34,0-0.618-0.278-0.618-0.618s0.278-0.618,0.618-0.618S14.738,9.661,14.738,10S14.46,10.619,14.12,10.619 M5.88,8.559c-0.795,0-1.442,0.646-1.442,1.442s0.646,1.443,1.442,1.443S7.322,10.796,7.322,10S6.675,8.559,5.88,8.559 M5.88,10.619c-0.34,0-0.618-0.278-0.618-0.618S5.54,9.382,5.88,9.382S6.498,9.661,6.498,10S6.22,10.619,5.88,10.619"></path>\n               </svg>',deleteTask:'<svg class="svg-icon" viewBox="0 0 20 20">\n                 <path d="M17.114,3.923h-4.589V2.427c0-0.252-0.207-0.459-0.46-0.459H7.935c-0.252,0-0.459,0.207-0.459,0.459v1.496h-4.59c-0.252,0-0.459,0.205-0.459,0.459c0,0.252,0.207,0.459,0.459,0.459h1.51v12.732c0,0.252,0.207,0.459,0.459,0.459h10.29c0.254,0,0.459-0.207,0.459-0.459V4.841h1.511c0.252,0,0.459-0.207,0.459-0.459C17.573,4.127,17.366,3.923,17.114,3.923M8.394,2.886h3.214v0.918H8.394V2.886z M14.686,17.114H5.314V4.841h9.372V17.114z M12.525,7.306v7.344c0,0.252-0.207,0.459-0.46,0.459s-0.458-0.207-0.458-0.459V7.306c0-0.254,0.205-0.459,0.458-0.459S12.525,7.051,12.525,7.306M8.394,7.306v7.344c0,0.252-0.207,0.459-0.459,0.459s-0.459-0.207-0.459-0.459V7.306c0-0.254,0.207-0.459,0.459-0.459S8.394,7.051,8.394,7.306"></path>\n                 </svg>',closeEditor:'<svg class="svg-icon" viewBox="0 0 20 20">\n                <path fill="none" d="M13.864,6.136c-0.22-0.219-0.576-0.219-0.795,0L10,9.206l-3.07-3.07c-0.219-0.219-0.575-0.219-0.795,0\n                    c-0.219,0.22-0.219,0.576,0,0.795L9.205,10l-3.07,3.07c-0.219,0.219-0.219,0.574,0,0.794c0.22,0.22,0.576,0.22,0.795,0L10,10.795\n                    l3.069,3.069c0.219,0.22,0.575,0.22,0.795,0c0.219-0.22,0.219-0.575,0-0.794L10.794,10l3.07-3.07\n                    C14.083,6.711,14.083,6.355,13.864,6.136z M10,0.792c-5.086,0-9.208,4.123-9.208,9.208c0,5.085,4.123,9.208,9.208,9.208\n                    s9.208-4.122,9.208-9.208C19.208,4.915,15.086,0.792,10,0.792z M10,18.058c-4.451,0-8.057-3.607-8.057-8.057\n                    c0-4.451,3.606-8.057,8.057-8.057c4.449,0,8.058,3.606,8.058,8.057C18.058,14.45,14.449,18.058,10,18.058z"></path>\n                </svg>',oopsError:'<svg xmlns="http://www.w3.org/2000/svg" id="oopsError" enable-background="new 0 0 512 512" height="80" viewBox="0 0 512 512" width="80">\n    <g>\n        <path d="m211 165c0-40.58-32.401-73.712-72.688-74.941-.766-.039-1.536-.059-2.312-.059s-1.546.02-2.312.059c-40.287 1.229-72.688 34.361-72.688 74.941 0 41.355 33.645 75 75 75s75-33.645 75-75zm-60-30c0 8.271-6.729 15-15 15s-15-6.729-15-15 6.729-15 15-15 15 6.729 15 15zm-15 75c-24.813 0-45-20.187-45-45 0-5.258.915-10.305 2.58-15 6.192 17.459 22.865 30 42.42 30s36.228-12.541 42.42-30c1.665 4.695 2.58 9.742 2.58 15 0 24.813-20.187 45-45 45z"/>\n        <path d="m451 165c0-40.58-32.401-73.712-72.688-74.941-.766-.039-1.536-.059-2.312-.059s-1.546.02-2.313.059c-40.286 1.229-72.687 34.361-72.687 74.941 0 41.355 33.645 75 75 75s75-33.645 75-75zm-60-30c0 8.271-6.729 15-15 15s-15-6.729-15-15 6.729-15 15-15 15 6.729 15 15zm-15 75c-24.813 0-45-20.187-45-45 0-5.258.915-10.305 2.58-15 6.192 17.459 22.865 30 42.42 30s36.228-12.541 42.42-30c1.665 4.695 2.58 9.742 2.58 15 0 24.813-20.187 45-45 45z"/>\n        <path d="m301 315v15h30v-15c0-41.355-33.645-75-75-75s-75 33.645-75 75v15h30v-15c0-24.813 20.187-45 45-45s45 20.187 45 45z"/>\n        <path d="m76 362c-24.813 0-45 20.187-45 45v60c0 24.813 20.187 45 45 45s45-20.187 45-45v-60c0-24.813-20.187-45-45-45zm15 105c0 8.271-6.729 15-15 15s-15-6.729-15-15v-60c0-8.271 6.729-15 15-15s15 6.729 15 15z"/>\n        <path d="m196 362c-24.813 0-45 20.187-45 45v60c0 24.813 20.187 45 45 45s45-20.187 45-45v-60c0-24.813-20.187-45-45-45zm15 105c0 8.271-6.729 15-15 15s-15-6.729-15-15v-60c0-8.271 6.729-15 15-15s15 6.729 15 15z"/>\n        <path d="m316 362h-45v150h30v-60h15c24.813 0 45-20.187 45-45s-20.187-45-45-45zm0 60h-15v-30h15c8.271 0 15 6.729 15 15s-6.729 15-15 15z"/>\n        <path d="m436 422c-8.271 0-15-6.729-15-15s6.729-15 15-15c4.006 0 7.773 1.56 10.607 4.394l10.607 10.606 21.213-21.214-10.607-10.606c-8.5-8.499-19.8-13.18-31.82-13.18-24.813 0-45 20.187-45 45s20.187 45 45 45c8.271 0 15 6.729 15 15s-6.729 15-15 15c-4.006 0-7.773-1.56-10.607-4.394l-10.607-10.606-21.213 21.214 10.607 10.606c8.5 8.499 19.8 13.18 31.82 13.18 24.813 0 45-20.187 45-45s-20.187-45-45-45z"/>\n        <path d="m211 15v-15h-30v15c0 24.813-20.187 45-45 45h-75v30h75c41.355 0 75-33.645 75-75z"/>\n        <path d="m451 60h-75c-24.813 0-45-20.187-45-45v-15h-30v15c0 41.355 33.645 75 75 75h75z"/>\n    </g>\n</svg>'},t.exports={svgPaths}},975:(t,e,s)=>{const i=s(176),a={monthLabel:(t,e=i.LOCALE)=>new Intl.DateTimeFormat(e.languageTag,{month:"long",year:"numeric"}).format(t),dateLabel:(t,e=i.LOCALE)=>new Intl.DateTimeFormat(e.languageTag,{weekday:"short",day:"numeric",month:"short",year:"numeric"}).format(t),toProperISOString:t=>t.toISOString().replace("Z","+00:00")};t.exports={copyObject:function(t){let e={};return Object.assign(e,t),e},getCookie:function(t){let e=null;if(document.cookie&&""!==document.cookie){const s=document.cookie.split(";");for(let i=0;i<s.length;i++){const a=s[i].trim();if(a.substring(0,t.length+1)===t+"="){e=decodeURIComponent(a.substring(t.length+1));break}}}return e},toDateField:function(t){if(t instanceof Date)return t;if("string"==typeof t){const e=new Date(t);if(isNaN(e.getDate()))throw new TypeError(`cannot make valid Date object from "${t}"`);return e}throw new TypeError(`cannot make valid Date object from "${t}" - only Date objects and strings are allowed as args`)},arraysEquals:function(t,e){return t.length===e.length&&t.every(((t,s)=>t===e[s]))},translate:function(t,e=i.LOCALE){if("en"===e.languageTag.slice(0,2).toLowerCase())return t;let s=e.lines[t];return"string"==typeof s?s:(console.error("no such line in the lines collection or wrong type of string provident:",t),t)},DateFormat:a,resetTimezone:function(t){let e=60*t.getTimezoneOffset()*1e3;return new Date(t.getTime()-e)},traverseNodeChildren:function t(e,s,i=[]){e.childElementCount<1||(e.childNodes.forEach((e=>{i.includes(e)||t(e,s,i)})),e.childNodes.forEach((t=>{s(t)})))}}},788:(t,e,s)=>{const i=s(176),{getCookie:a,translate:n}=s(975),{MissingServerError:o,ServerError:r,ClientError:h}=s(733);t.exports={TransportService:class{constructor(t=i.SERVER_URLs){this.urls=t}fetchFromServer(...t){return fetch(...t).then((t=>this._checkResponseForErrors(t))).catch((t=>{throw"Failed to fetch"===t.message?new o(n("server is temporary unavailable..")):t}))}_checkResponseForErrors(t){if(t.ok)return Promise.resolve(t);if(500<=t.status<=511)throw new r("we have some problems on the server",t.status);if(400<=t.status<=451)throw new h("we have some error in the application",t.status)}getMonthPack(t){let e=t.toISOString().replace("Z","+00:00"),s=new URL(this.urls.changeDate,this.urls.base);return s.searchParams.append("date",e),this.fetchFromServer(s).then((t=>t.json()))}addNewTask(t){const e=new URL(this.urls.tasks+"/",this.urls.base),s={method:"POST",mode:"cors",credentials:"same-origin",headers:{"X-CSRFToken":a("csrftoken"),"Content-Type":"application/json"},body:JSON.stringify(t)};return this.fetchFromServer(e,s)}deleteTask(t){const e=new URL(this.urls.tasks+`/${t}`,this.urls.base),s={method:"DELETE",mode:"cors",credentials:"same-origin",headers:{"X-CSRFToken":a("csrftoken")}};return this.fetchFromServer(e,s)}changeTask(t,e=!1){const s=new URL(this.urls.tasks+`/${t.id}/`,this.urls.base),i={method:"PUT",mode:"cors",credentials:"same-origin",headers:{"X-CSRFToken":a("csrftoken"),"Content-Type":"application/json"},body:JSON.stringify(t)};return e&&(i.headers.checkUncheck=1),this.fetchFromServer(s,i)}}}},59:(t,e,s)=>{const{Widget:i}=s(401),{IconButton24:a}=s(604),{svgPaths:n}=s(201),{DateFormat:o,resetTimezone:r}=s(975);class h extends i{constructor(t,e,s){super(t),this.tag="button",this.element=document.createElement(this.tag),this.id=this.makeId("dBtn"),this.element.className="c-daysFrame__dayButton",this.cacheService=s,this.date=e,this.options={onclick:this.boundSelf.bind(this)},this.configurate(this.date)}updStatus(){let t=this.cacheService.tasksArray.checkDailyTasks(this.date),e=this.element.classList;if("no tasks"===t)e.add("--no-tasks"),e.remove("--tasks-done","--got-tasks");else if("tasks done"===t)e.add("--tasks-done"),e.remove("--no-tasks","--got-tasks");else{if("got tasks"!==t)throw"no such status: "+t;e.add("--got-tasks"),e.remove("--no-tasks","--tasks-done")}}configurate(t){this.date=t,this.element.innerText=t.getDate(),this.updStatus(),this.date.toDateString()===this.cacheService.today.toDateString()?this.element.classList.add("--today"):this.element.classList.remove("--today"),this.date.getMonth()!=this.cacheService.pageDate.getMonth()?this.element.classList.add("--out-month"):this.element.classList.remove("--out-month")}reqChangeDate(t){this.date=t,this.configurate(t)}reachTaskPanel(){let t=i.instanceList["tp-taskpanel"];if(!t)throw`DayButton on the calendar cannot reach taskPanel widget by id "tp-taskpanel": ${this.id}`;return t}boundSelf(){this.reachTaskPanel().boundDayBt(this)}}t.exports={DayButton:h,Calendar:class extends i{constructor(t,e){super(t),this.id="c-calendar",this.cacheService=e,this.date=this.cacheService.pageDate,this.daysArr=this.cacheService.datesArray,this.childWidgets=[this.Topbar=new i(this,{id:"c-topbar"}),this.DaysFrame=new i(this,{id:"c-daysFrame"}),this.PrevMonthBtn=new a(this.Topbar,{id:"monthBack-bt",onclick:this.toPrevMonth.bind(this)},n.pointLeft),this.MonthLabel=new i(this.Topbar,{id:"c-topbar__monthLabel",innerText:o.monthLabel(this.date),onclick:this.switchLabelToPicker.bind(this)}),this.MonthPicker=new i(this.Topbar,{id:"c-topbar__monthPicker",tagName:"input",type:"month",value:this.date.toISOString().slice(0,7),onmouseout:this.switchPickerToLabel.bind(this)}),this.NextMonthBtn=new a(this.Topbar,{id:"monthForv-bt",onclick:this.toNextMonth.bind(this)},n.pointRight)],this.DayButtonArr=this.initDayButtons(this.DaysFrame,this.daysArr),this.PrevMonthBtn.addCssClass("c-topbar__swtcMonthBt"),this.NextMonthBtn.addCssClass("c-topbar__swtcMonthBt")}build(){super.build(),this.childWidgets.forEach((t=>t.build())),this.listenToMonthPicker(),this.DayButtonArr.forEach((t=>t.build()))}switchLabelToPicker(){this.MonthLabel.hide(),this.MonthPicker.show("block")}switchPickerToLabel(){this.MonthLabel.show(),this.MonthPicker.hide()}listenToMonthPicker(){this.MonthPicker.element.addEventListener("change",(t=>{this.reqChangeDate(new Date(t.target.value))}))}initDayButtons(t,e){let s=[];for(let i of e){let e=new h(t,i,this.cacheService);s.push(e)}return s}configurateDayButtons(t){let e=0;for(let s of this.DayButtonArr)s.configurate(t[e]),e+=1}updDayButtonsStatus(){this.DayButtonArr.forEach((t=>t.updStatus()))}reqChangeDate(t){this.cacheService.setPageDate(t).then((()=>{this.date=this.cacheService.pageDate,this.daysArr=this.cacheService.datesArray,this.configurateDayButtons(this.daysArr),this.MonthLabel.element.innerText=o.monthLabel(this.date)})).catch((t=>{throw console.log("error catched in the end-point"),t}))}toNextMonth(){let t,e;11===this.date.getMonth()?(t=0,e=this.date.getYear()+1+1900):(t=this.date.getMonth()+1,e=this.date.getYear()+1900);let s=new Date(e,t);this.reqChangeDate(r(s))}toPrevMonth(){let t,e;0===this.date.getMonth()?(t=11,e=this.date.getYear()-1+1900):(t=this.date.getMonth()-1,e=this.date.getYear()+1900);let s=new Date(e,t);this.reqChangeDate(r(s))}refreshMonth(){this.reqChangeDate(this.date)}}}},604:(t,e,s)=>{const{Widget:i}=s(401),{translate:a}=s(975);t.exports={IconButton24:class extends i{constructor(t,e={},s){super(t,e),this.tag="button",this.element=document.createElement(this.tag),this.element.className="button-icon24",this.SvgIcon=i.fromHTML(this,s)}build(){super.build(),this.SvgIcon.build(),this.defaultOptions.onclick&&(this.element.onclick=this.defaultOptions.onclick),this.defaultOptions.context&&(this.element.context=this.defaultOptions.context)}},Select:class extends i{constructor(t,e){super(t),this.tag="select",this.element=document.createElement(this.tag),this.optionsList=this.initOptions(e),this.defaultValue}get value(){return this.element.value}set value(t){this.element.value=t}initOptions(t){let e=[];return t.forEach((t=>{let s=t[0],n=a(t[1]);const o=new i(this,{tagName:"option",value:s,text:n});e.push(o)})),e}build(){super.build(),this.optionsList.forEach((t=>t.build())),this.defaultValue&&(this.value=this.defaultValue)}}}},401:(t,e,s)=>{const{copyObject:i}=s(975),a={};class n{constructor(t,e={}){this._checkTypes(t,e),this.parent=t,this.element=document.createElement(e.tagName?e.tagName:"DIV"),this.options=e,this.id=e.id?e.id:this.makeId("w"),this.defaultOptions=i(e),this._defaultDisplayMode}set options(t){delete t.tagName;try{Object.assign(this.element,t)}catch(e){throw console.error(`cannot assign given options ${t} to theHTML element of the Widget`),e}}static fromHTML(t,e){let s=this.makeElementFromHTML(e),i=new n(t);return i.element=s,i}static makeElementFromHTML(t){return(new DOMParser).parseFromString(t,"text/html").body.firstElementChild}build(){try{this.element.id=this.id,document.getElementById(this.parent.id).insertAdjacentElement("beforeend",this.element),this._defaultDisplayMode=this.element.style.display,a[this.id]=this}catch(t){throw console.error("cannot build Widget:",this),t}}isBuilded(){return!!document.getElementById(this.id)}makeId(t){return t+Math.floor(99999*Math.random())}remove(){delete a[this.id],this.element.remove()}hide(){if("none"!=this._defaultDisplayMode){let t=this.element.style.display;this.element._defaultDisplayMode=t}this.element.style.display="none"}show(t){this.element.style.display=t||this._defaultDisplayMode}disable(){this.element.disabled=!0}enable(){this.element.disabled=!1}addCssClass(t){this.element.classList.add(t)}removeCssClass(t){this.element.classList.remove(t)}static get instanceList(){return a}_checkTypes(t,e){if(!(t instanceof n)&"_main-container"!=t.id)throw new TypeError("first argument (parent) should be an instance of Widget")}}t.exports={Widget:n}},54:(t,e,s)=>{const{Widget:i}=s(401),{translate:a,traverseNodeChildren:n}=s(975);t.exports={PopUpWindow:class extends i{constructor(t){super(t.parent),this.cssClass=t.cssClass,this.onclose=t.onclose,t.caption&&(this.Caption=new i(this,{className:"popup-caption",innerText:t.caption})),t.svgPicture&&(this.SvgPicture=i.fromHTML(this,t.svgPicture)),t.irreversible||(this.ConformButton=new i(this,{tagName:"button",innerText:a("ok"),onclick:this.close.bind(this)}))}build(){super.build(),this.addCssClass("popup"),this.cssClass&&this.addCssClass(this.cssClass),this.SvgPicture&&this.SvgPicture.build(),this.Caption&&this.Caption.build(),this.ConformButton&&this.ConformButton.build(),this.setDisabledForParent(!0)}close(){this.onclose&&this.onclose(),this.setDisabledForParent(!1),this.remove()}setDisabledForParent(t){if("boolean"!=typeof t)throw TypeError("the function requires a boolean value as an argument");let e;e="_main-container"===this.parent.id?this.parent:this.parent.element,n(e,(e=>{e.disabled=t}),[this.element]),e.childNodes.forEach((e=>{e!=this.element&&(e.style.filter=t?"brightness(0.5)":"brightness(1)")}))}}}},861:(module,__unused_webpack_exports,__webpack_require__)=>{const{Widget}=__webpack_require__(401),{IconButton24,Select}=__webpack_require__(604),{svgPaths}=__webpack_require__(201),{DateFormat,translate}=__webpack_require__(975),{PopUpWindow}=__webpack_require__(54);class TaskPanel extends Widget{constructor(t,e){super(t),this.id="tp-taskpanel",this.cacheService=e,this.relatedDayButton,this.Topbar=new Widget(this,{id:"tp-topbar"}),this.DateLabel=new Widget(this.Topbar,{id:"tp-dateLabel",innerText:""}),this.TaskList=new TaskList(this),this.CreateTaskBt=new IconButton24(this.Topbar,{id:"tp-createTaskBt",onclick:this.TaskList.openTaskAdder.bind(this.TaskList)},svgPaths.addTask)}get dailyTaskArray(){if(this.relatedDayButton){let t=this.relatedDayButton.date;return this.cacheService.tasksArray.getDailyTasks(t)}return[]}build(){super.build(),this.Topbar.build(),this.DateLabel.build(),this.TaskList.build()}boundDayBt(t){this.relatedDayButton=t,this.TaskList.update(),this.DateLabel.element.innerText=DateFormat.dateLabel(t.date),this.CreateTaskBt.isBuilded()||this.CreateTaskBt.build()}}class TaskList extends Widget{constructor(t){super(t),this.parent=t,this.id="tp-taskList",this.cacheService=this.parent.cacheService,this.options={innerText:translate("No tasks")},this.taskItemArray=this.initTaskItems()}initTaskItems(){let t=this.taskArray;if(t){let e=[];for(let s of t){let t=new TaskItem(this,s);e.push(t)}return e}}build(){super.build(),this.makeListObserver(),this.buildTaskItems()}buildTaskItems(){this.taskItemArray&&this.taskItemArray.forEach((t=>t.build()))}makeListObserver(){new MutationObserver(((t,e)=>{for(let e of t)return void(e.target.childElementCount?e.target.style.fontSize="0px":e.target.style.fontSize="18px")})).observe(this.element,{attributes:!1,childList:!0,subtree:!1})}clear(){this.taskItemArray.forEach((t=>t.remove()))}update(){this.clear(),this.taskItemArray=this.initTaskItems(),this.buildTaskItems()}openTaskAdder(){let t=new TaskAdder(this);this.taskItemArray.push(t),t.build()}get relatedDayButton(){return this.parent.relatedDayButton}get taskArray(){return this.parent.dailyTaskArray}get date(){return this.parent.relatedDayButton.date}}class TaskItem extends Widget{constructor(t,e){super(t),this.parent=t,this.cacheService=this.parent.cacheService,this.taskObj=e||this._emptyTaskObj,this.id=this.makeId("ti"),this.element.className="tp-taskitem",this.checkDone=new Widget(this,{tagName:"input",className:"tp-taskCheckout",type:"checkbox",checked:this.taskObj.completion,onclick:this.checkUncheckCompletion.bind(this)}),this.Main=new Widget(this,{className:"tp-taskitemMain"}),this.defaultWidgets=[this.Title=new Widget(this.Main,{className:"tp-taskitemTitle",innerText:this.taskObj.title}),this.Description=new Widget(this.Main,{className:"tp-taskitemDescr",innerText:this.taskObj.description})],this.editingWidgets=[this.SaveCloseCont=new Widget(this.Main,{className:"tp-taskitemSaveClose"}),this.SaveButton=new IconButton24(this.SaveCloseCont,{className:"save_task",onclick:this.saveInputValues.bind(this)},svgPaths.saveTask),this.CloseEditorButton=new IconButton24(this.SaveCloseCont,{className:"closeEditor",onclick:this.switchToDefaultMode.bind(this)},svgPaths.closeEditor),this.TaskTimeSettingsCont=new Widget(this.Main,{className:"tp-taskTimeSettings"}),this.DateSettings=new TaskSettingsElement(this.TaskTimeSettingsCont,"date",this.taskObj,translate("Postpone:")),this.IntervalSettings=new TaskSettingsElement(this.TaskTimeSettingsCont,"interval",this.taskObj,translate("Repeat:")),this.AutoshiftSettings=new TaskSettingsElement(this.TaskTimeSettingsCont,"autoshift",this.taskObj,translate("Auto postpone:")),this.InputTitle=new TaskSettingsElement(this.Main,"input",this.taskObj,translate("Task name:")),this.InputDescription=new TaskSettingsElement(this.Main,"textarea",this.taskObj,translate("Description:"))],this.RightButtons=[this.RightButtonsCont=new Widget(this,{className:"tp-taskitemRightBtns"}),this.EditTaskButton=new IconButton24(this.RightButtonsCont,{className:"button-icon24",onclick:this.switchToEditMode.bind(this)},svgPaths.editTask),this.DeleteTaskButton=new IconButton24(this.RightButtonsCont,{className:"button-icon24",onclick:this.removeSelf.bind(this)},svgPaths.deleteTask)]}build(){super.build(),this.checkDone.build(),this.Main.build(),this.RightButtons.forEach((t=>t.build())),this.SaveButton.addCssClass("ti-SaveTaskBt"),this.CloseEditorButton.addCssClass("ti-CloseEditorBt"),this.DeleteTaskButton.addCssClass("tp-RightBtnsDelTask"),this.EditTaskButton.addCssClass("tp-RightBtnsEditTask"),this.defaultWidgets.forEach((t=>t.build()))}switchToEditMode(){this.checkDone.hide(),this.RightButtonsCont.hide(),this.defaultWidgets.forEach((t=>t.hide())),this.editingWidgets.forEach((t=>{t.isBuilded()?t.show():(t.build(),this.bindKeysToInputWidget(t))})),this.makeConstraints(),this.makeChangesObserver()}switchToDefaultMode(){this.checkDone.show(),this.defaultWidgets.forEach((t=>t.show())),this.editingWidgets.forEach((t=>t.hide())),this.RightButtonsCont.show()}removeSelf(){this.cacheService.deleteTask(this.taskObj).then((()=>{this.remove(),this.taskObj.interval?calendar.refreshMonth():this.relatedDayButton.updStatus()})).catch((t=>{throw t}))}takeInputValues(){return{init_date:new Date(this.DateSettings.value),date:new Date(this.DateSettings.value),interval:this.IntervalSettings.value,autoshift:eval(this.AutoshiftSettings.value),title:this.InputTitle.value,description:this.InputDescription.value}}updateFields(t){this.Title.element.innerText=t.title,this.Description.element.innerText=t.description}makeConstraints(){const t=this.DateSettings.inputWidget,e=this.IntervalSettings.inputWidget,s=this.AutoshiftSettings.inputWidget,i=this.checkDone.element;"no"!=e.value||i.checked?(t.disable(),s.disable()):i.checked||(t.enable(),s.enable()),e.element.addEventListener("change",(e=>{"no"==e.target.value||i.checked?i.checked||(t.enable(),s.enable()):(t.disable(),s.disable())})),"true"===s.value&&e.disable(),s.element.addEventListener("change",(t=>{"true"===t.target.value?e.disable():e.enable()}))}makeChangesObserver(){this.editingWidgets.forEach((t=>{t.hasOwnProperty("inputWidget")&&t.inputWidget.element.addEventListener("change",(t=>{t.target.value!=Widget.instanceList[t.target.id].defaultOptions.value&&this.SaveButton.show()}))}))}saveInputValues(){let t=this.takeInputValues();t.id=this.taskObj.id,t.title?this.cacheService.editTask(t).then((()=>{calendar.updDayButtonsStatus(),taskPanel.TaskList.update()})).catch((t=>{console.error(t)})):new PopUpWindow({parent:_mainContainer,cssClass:"popup-defaultError",caption:translate("A task should have a title")}).build()}bindKeysToInputWidget(t){t.inputWidget&&t.inputWidget.element.addEventListener("keydown",(t=>{t.ctrlKey&&"Enter"===t.key&&this.saveInputValues().then(this.switchToDefaultMode())}))}checkUncheckCompletion(){let t={id:this.taskObj.id,date:this.taskObj.date};this.checkDone.element.checked?t.completion=this.taskObj.date:t.completion=!1,this.cacheService.checkUncheckTask(t).then((()=>{this.relatedDayButton.updStatus()}))}get relatedDayButton(){return this.parent.relatedDayButton}get _emptyTaskObj(){return console.log(this.parent),TaskObject.getEmpty({date:this.parent.date,init_date:this.parent.date})}}class TaskAdder extends TaskItem{constructor(t){super(t),this.id=this.makeId("ta")}build(){super.build(),this.switchToEditMode(),this.reBind(),this.element.style.order="-1"}reBind(){this.CloseEditorButton.element.onclick=this.remove.bind(this),this.SaveButton.element.onclick=this.createNewTask.bind(this)}createNewTask(){let t,e=this.takeInputValues();e.id=this.taskObj.id,e.title?(t=!(!e.interval||"no"==e.interval),this.cacheService.createTask(e).then((()=>{this.remove(),calendar.updDayButtonsStatus(),taskPanel.TaskList.update(),t&&calendar.refreshMonth()})).catch((t=>{console.error("catched in the end point:",t)}))):new PopUpWindow({parent:_mainContainer,cssClass:"popup-defaultError",caption:translate("A task should have a title")}).build()}bindKeysToInputWidget(t){t.inputWidget&&t.inputWidget.element.addEventListener("keydown",(t=>{t.ctrlKey&&"Enter"===t.key&&this.createNewTask().then(this.switchToDefaultMode())}))}}class TaskSettingsElement extends Widget{constructor(t,e,s,i){super(t),this.parent=t,this.element.className="tp-SettingsElement",this.taskObj=s,this.inputWidget=this.initInputWg(e),this.label=new Widget(this,{tagName:"label",innerText:i})}build(){super.build(),this.label.build(),this.inputWidget.build()}get value(){return this.inputWidget.value}set value(t){this.inputWidget.value=t}initInputWg(t){if("date"===t)return new Widget(this,{tagName:"input",type:"date",name:"new_date",value:this.taskObj.init_date.toISOString().slice(0,10)});if("interval"===t){const t=new Select(this,[["no","no interval"],["every_day","every day"],["every_workday","every workday"],["every_week","every week"],["every_month","every month"],["every_year","every year"]]);return t.defaultValue=this.taskObj.interval,t}if("autoshift"===t){const t=new Select(this,[[!1,"no"],[!0,"until completed"]]);return t.defaultValue=this.taskObj.autoshift,t}if("input"===t){const t=new Widget(this,{tagName:"input",type:"text",name:"new_title",value:this.taskObj.title});return t.element.setAttribute("maxlength",80),t.element.setAttribute("minlength",1),t.element.setAttribute("required",!0),t}return"textarea"===t?new Widget(this,{tagName:"textarea",name:"newDescription",rows:"5",cols:"3",value:this.taskObj.description}):void 0}get value(){return this.inputWidget.element.value}set value(t){this.inputWidget.element.value=t}get cacheService(){return this.parent.cacheService}}module.exports={TaskPanel}}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}var __webpack_exports__={};(()=>{const{Widget:t}=__webpack_require__(401),{DayButton:e,Calendar:s}=__webpack_require__(59),{IconButton24:i}=__webpack_require__(604),{TaskPanel:a}=__webpack_require__(861),{PopUpWindow:n}=__webpack_require__(54),{copyObject:o}=__webpack_require__(975),{CacheService:r,TaskObject:h}=__webpack_require__(193),{TransportService:c}=__webpack_require__(788),{svgPaths:l}=__webpack_require__(201),d=__webpack_require__(176),u=document.getElementById("_main-container");window.Widget=t,window._mainContainer=u,window.copyObject=o,window.TaskObject=h,window.TransportService=c,window.CacheService=r,window.DayButton=e,window.Calendar=s,window.IconButton24=i,window.svgPaths=l,window.TaskPanel=a,window.PopUpWindow=n,window.launchApp=function(t,e){e&&Object.assign(d,e);const i=new c,n=new r(i);let o,h;n.setPageDate(n.today).then((()=>{o=new s(t,n),h=new a(t,n),o.build(),h.build()})).catch((t=>{throw console.error(t),alert("sorry, the app is unavailable now"),t})).then((()=>{window.calendar=o,window.taskPanel=h}))},window.appConfig=d})()})();